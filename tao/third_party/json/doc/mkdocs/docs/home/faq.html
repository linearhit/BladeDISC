

<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Frequently Asked Questions (FAQ) &mdash; BladeDISC 1.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../../../../../../_static/css/theme.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../../_static/css/theme.min.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../../../_static/copybutton.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../../search.html" /> 

</head>

<body>
    <header>
        <div class="container">
            <a class="site-nav-toggle hidden-lg-up"><i class="icon-menu"></i></a>
            <a class="site-title" href="../../../../../../../index.html">
                BladeDISC
            </a>
        </div>
    </header>


<div class="breadcrumbs-outer hidden-xs-down">
    <div class="container">
        















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="breadcrumbs">
    
      <li><a href="../../../../../../../index.html">Docs</a></li>
        
      <li>Frequently Asked Questions (FAQ)</li>
    
    
      <li class="breadcrumbs-aside">
        
            
            <a href="../../../../../../../_sources/tao/third_party/json/doc/mkdocs/docs/home/faq.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
</div>
    </div>
</div>
    <div class="main-outer">
        <div class="container">
            <div class="row">
                <div class="col-12 col-lg-3 site-nav">
                    
<div role="search">
    <form class="search" action="../../../../../../../search.html" method="get">
        <div class="icon-input">
            <input type="text" name="q" placeholder="Search" />
            <span class="icon-search"></span>
        </div>
        <input type="submit" value="Go" class="d-hidden" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div>
                    <div class="site-nav-tree">
                        
                            
                            
                                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../README_.html">BladeDISC Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../README_.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../README_.html#api-quickview">API QuickView</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../README_.html#for-pytorch-users">For PyTorch Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../README_.html#setup-and-examples">Setup and Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../README_.html#publications">Publications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../README_.html#tutorials-and-documents-for-developers">Tutorials and Documents for Developers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../README_.html#how-to-contribute">How to Contribute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../README_.html#faq">FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../README_.html#contact-us">Contact Us</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../docs/install_with_docker.html">Install with Docker</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../docs/install_with_docker.html#download-a-bladedisc-docker-image">Download a BladeDISC Docker Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../docs/install_with_docker.html#start-a-docker-container">Start a Docker Container</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../docs/build_from_source.html">Build from Source</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../docs/build_from_source.html#prerequisite">Prerequisite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../docs/build_from_source.html#checkout-the-source">Checkout the Source</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../docs/build_from_source.html#building-bladedisc-for-tensorflow-users">Building BladeDISC for TensorFlow Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../docs/build_from_source.html#building-bladedisc-for-pytorch-users">Building BladeDISC for PyTorch Users</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../docs/quickstart.html">Quickstart for TensorFlow/PyTorch users</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../docs/quickstart.html#quickstart-for-tensorflow-users">Quickstart for TensorFlow Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../docs/quickstart.html#quickstart-for-pytorch-users">Quickstart for PyTorch Users</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../docs/contribution.html">How to Contribute</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../docs/contribution.html#local-development-environment">Local Development Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../docs/contribution.html#submit-a-pull-request-to-bladedisc">Submit a Pull Request to BladeDISC</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../docs/developers/index.html">Documentation for Developers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../docs/developers/pass_pipeline.html">Tutorial: A Walkthough of the BladeDISC Pass Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../docs/developers/runtime_abstraction_layer.html">Runtime Abstraction Layer Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../docs/developers/bladedisc_torch_overview.html">BladeDISC Torch Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../docs/developers/torch_add_a_new_converter.html">Tutorial: How to add the support of a new Torch Op</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../../../docs/tutorials/index.html">Tutorials on Example Use Cases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../docs/tutorials/tensorflow_inference_and_training.html">Use case of TensorFlow Inference and Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../../../docs/tutorials/torch_bert_inference.html">Use case of PyTorch Inference</a></li>
</ul>
</li>
</ul>

                            
                        
                    </div>
                </div>
                <div class="col-12 col-lg-9">
                    <div class="document">
                        
                            
  <div class="section" id="frequently-asked-questions-faq">
<h1>Frequently Asked Questions (FAQ)<a class="headerlink" href="#frequently-asked-questions-faq" title="Permalink to this headline">¶</a></h1>
<div class="section" id="known-bugs">
<h2>Known bugs<a class="headerlink" href="#known-bugs" title="Permalink to this headline">¶</a></h2>
<div class="section" id="brace-initialization-yields-arrays">
<h3>Brace initialization yields arrays<a class="headerlink" href="#brace-initialization-yields-arrays" title="Permalink to this headline">¶</a></h3>
<p>!!! question</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Why does

```cpp
json j{true};
```

and

```cpp
json j(true);
```

yield different results (`#!json [true]` vs. `#!json true`)?
</pre></div>
</div>
<p>This is a known issue, and – even worse – the behavior differs between GCC and Clang. The “culprit” for this is the library’s constructor overloads for initializer lists to allow syntax like</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">json</span> <span class="n">array</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">};</span>
</pre></div>
</div>
<p>for arrays and</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">json</span> <span class="n">object</span> <span class="o">=</span> <span class="p">{{</span><span class="s">&quot;one&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="s">&quot;two&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">}};</span> 
</pre></div>
</div>
<p>for objects.</p>
<p>!!! tip</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>To avoid any confusion and ensure portable code, **do not** use brace initialization with the types `basic_json`, `json`, or `ordered_json` unless you want to create an object or array as shown in the examples above.
</pre></div>
</div>
</div>
</div>
<div class="section" id="limitations">
<h2>Limitations<a class="headerlink" href="#limitations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="relaxed-parsing">
<h3>Relaxed parsing<a class="headerlink" href="#relaxed-parsing" title="Permalink to this headline">¶</a></h3>
<p>!!! question</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Can you add an option to ignore trailing commas?
</pre></div>
</div>
<p>This library does not support any feature which would jeopardize interoperability.</p>
</div>
<div class="section" id="parse-errors-reading-non-ascii-characters">
<h3>Parse errors reading non-ASCII characters<a class="headerlink" href="#parse-errors-reading-non-ascii-characters" title="Permalink to this headline">¶</a></h3>
<p>!!! question “Questions”</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>- Why is the parser complaining about a Chinese character?
- Does the library support Unicode?
- I get an exception `[json.exception.parse_error.101] parse error at line 1, column 53: syntax error while parsing value - invalid string: ill-formed UTF-8 byte; last read: &#39;&quot;Testé$&#39;)&quot;`
</pre></div>
</div>
<p>The library supports <strong>Unicode input</strong> as follows:</p>
<ul class="simple">
<li><p>Only <strong>UTF-8</strong> encoded input is supported which is the default encoding for JSON according to <a class="reference external" href="https://tools.ietf.org/html/rfc8259.html#section-8.1">RFC 8259</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">std::u16string</span></code> and <code class="docutils literal notranslate"><span class="pre">std::u32string</span></code> can be parsed, assuming UTF-16 and UTF-32 encoding, respectively. These encodings are not supported when reading from files or other input containers.</p></li>
<li><p>Other encodings such as Latin-1 or ISO 8859-1 are <strong>not</strong> supported and will yield parse or serialization errors.</p></li>
<li><p><a class="reference external" href="http://www.unicode.org/faq/private_use.html#nonchar1">Unicode noncharacters</a> will not be replaced by the library.</p></li>
<li><p>Invalid surrogates (e.g., incomplete pairs such as <code class="docutils literal notranslate"><span class="pre">\uDEAD</span></code>) will yield parse errors.</p></li>
<li><p>The strings stored in the library are UTF-8 encoded. When using the default string type (<code class="docutils literal notranslate"><span class="pre">std::string</span></code>), note that its length/size functions return the number of stored bytes rather than the number of characters or glyphs.</p></li>
<li><p>When you store strings with different encodings in the library, calling <a class="reference external" href="https://nlohmann.github.io/json/classnlohmann_1_1basic__json_a50ec80b02d0f3f51130d4abb5d1cfdc5.html#a50ec80b02d0f3f51130d4abb5d1cfdc5"><code class="docutils literal notranslate"><span class="pre">dump()</span></code></a> may throw an exception unless <code class="docutils literal notranslate"><span class="pre">json::error_handler_t::replace</span></code> or <code class="docutils literal notranslate"><span class="pre">json::error_handler_t::ignore</span></code> are used as error handlers.</p></li>
</ul>
<p>In most cases, the parser is right to complain, because the input is not UTF-8 encoded. This is especially true for Microsoft Windows where Latin-1 or ISO 8859-1 is often the standard encoding.</p>
</div>
<div class="section" id="wide-string-handling">
<h3>Wide string handling<a class="headerlink" href="#wide-string-handling" title="Permalink to this headline">¶</a></h3>
<p>!!! question</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Why are wide strings (e.g., `std::wstring`) dumped as arrays of numbers?
</pre></div>
</div>
<p>As described <a class="reference external" href="#parse-errors-reading-non-ascii-characters">above</a>, the library assumes UTF-8 as encoding.  To store a wide string, you need to change the encoding.</p>
<p>!!! example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>```cpp
#include &lt;codecvt&gt; // codecvt_utf8
#include &lt;locale&gt;  // wstring_convert

// encoding function
std::string to_utf8(std::wstring&amp; wide_string)
{
    static std::wstring_convert&lt;std::codecvt_utf8&lt;wchar_t&gt;&gt; utf8_conv;
    return utf8_conv.to_bytes(wide_string);
}

json j;
std::wstring ws = L&quot;車B1234 こんにちは&quot;;

j[&quot;original&quot;] = ws;
j[&quot;encoded&quot;] = to_utf8(ws);

std::cout &lt;&lt; j &lt;&lt; std::endl;
```

The result is:

```json
{
  &quot;encoded&quot;: &quot;車B1234 こんにちは&quot;,
  &quot;original&quot;: [36554, 66, 49, 50, 51, 52, 32, 12371, 12435, 12395, 12385, 12399]
}
```
</pre></div>
</div>
</div>
</div>
<div class="section" id="exceptions">
<h2>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="parsing-without-exceptions">
<h3>Parsing without exceptions<a class="headerlink" href="#parsing-without-exceptions" title="Permalink to this headline">¶</a></h3>
<p>!!! question</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Is it possible to indicate a parse error without throwing an exception?
</pre></div>
</div>
<p>Yes, see <a class="reference internal" href="../features/parsing/parse_exceptions.html"><span class="doc">Parsing and exceptions</span></a>.</p>
</div>
<div class="section" id="key-name-in-exceptions">
<h3>Key name in exceptions<a class="headerlink" href="#key-name-in-exceptions" title="Permalink to this headline">¶</a></h3>
<p>!!! question</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Can I get the key of the object item that caused an exception?
</pre></div>
</div>
<p>Yes, you can. Please define the symbol JSON_DIAGNOSTICS to get <a class="reference internal" href="exceptions.html#extended-diagnostic-messages"><span class="std std-ref">extended diagnostics messages</span></a>.</p>
</div>
</div>
<div class="section" id="serialization-issues">
<h2>Serialization issues<a class="headerlink" href="#serialization-issues" title="Permalink to this headline">¶</a></h2>
<div class="section" id="number-precision">
<h3>Number precision<a class="headerlink" href="#number-precision" title="Permalink to this headline">¶</a></h3>
<p>!!! question</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>- It seems that precision is lost when serializing a double.
- Can I change the precision for floating-point serialization?
</pre></div>
</div>
<p>The library uses <code class="docutils literal notranslate"><span class="pre">std::numeric_limits&lt;number_float_t&gt;::digits10</span></code> (15 for IEEE <code class="docutils literal notranslate"><span class="pre">double</span></code>s) digits for serialization. This value is sufficient to guarantee roundtripping. If one uses more than this number of digits of precision, then string -&gt; value -&gt; string is not guaranteed to round-trip.</p>
<p>!!! quote “<a class="reference external" href="https://en.cppreference.com/w/cpp/types/numeric_limits/digits10">cppreference.com</a>”</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>The value of `std::numeric_limits&lt;T&gt;::digits10` is the number of base-10 digits that can be represented by the type T without change, that is, any number with this many significant decimal digits can be converted to a value of type T and back to decimal form, without change due to rounding or overflow. 
</pre></div>
</div>
<p>!!! tip</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">website</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="nb">float</span><span class="o">.</span><span class="n">exposed</span> <span class="n">gives</span> <span class="n">a</span> <span class="n">good</span> <span class="n">insight</span> <span class="n">into</span> <span class="n">the</span> <span class="n">internal</span> <span class="n">storage</span> <span class="n">of</span> <span class="n">floating</span><span class="o">-</span><span class="n">point</span> <span class="n">numbers</span><span class="o">.</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="../features/types/number_handling.html#number-serialization"><span class="std std-ref">this section</span></a> on the library’s number handling for more information.</p>
</div>
</div>
<div class="section" id="compilation-issues">
<h2>Compilation issues<a class="headerlink" href="#compilation-issues" title="Permalink to this headline">¶</a></h2>
<div class="section" id="android-sdk">
<h3>Android SDK<a class="headerlink" href="#android-sdk" title="Permalink to this headline">¶</a></h3>
<p>!!! question</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Why does the code not compile with Android SDK?
</pre></div>
</div>
<p>Android defaults to using very old compilers and C++ libraries. To fix this, add the following to your <code class="docutils literal notranslate"><span class="pre">Application.mk</span></code>. This will switch to the LLVM C++ library, the Clang compiler, and enable C++11 and other features disabled by default.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">APP_STL :</span><span class="o">=</span> <span class="s">c++_shared</span>
<span class="na">NDK_TOOLCHAIN_VERSION :</span><span class="o">=</span> <span class="s">clang3.6</span>
<span class="na">APP_CPPFLAGS +</span><span class="o">=</span> <span class="s">-frtti -fexceptions</span>
</pre></div>
</div>
<p>The code compiles successfully with <a class="reference external" href="https://developer.android.com/ndk/index.html?hl=ml">Android NDK</a>, Revision 9 - 11 (and possibly later) and <a class="reference external" href="https://www.crystax.net/en/android/ndk">CrystaX’s Android NDK</a> version 10.</p>
</div>
<div class="section" id="missing-stl-function">
<h3>Missing STL function<a class="headerlink" href="#missing-stl-function" title="Permalink to this headline">¶</a></h3>
<p>!!! question “Questions”</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>- Why do I get a compilation error `&#39;to_string&#39; is not a member of &#39;std&#39;` (or similarly, for `strtod` or `strtof`)?
- Why does the code not compile with MinGW or Android SDK?
</pre></div>
</div>
<p>This is not an issue with the code,  but rather with the compiler itself. On Android, see above to build with a newer environment.  For MinGW, please refer to <a class="reference external" href="http://tehsausage.com/mingw-to-string">this site</a> and <a class="reference external" href="https://github.com/nlohmann/json/issues/136">this discussion</a> for information on how to fix this bug. For Android NDK using <code class="docutils literal notranslate"><span class="pre">APP_STL</span> <span class="pre">:=</span> <span class="pre">gnustl_static</span></code>, please refer to <a class="reference external" href="https://github.com/nlohmann/json/issues/219">this discussion</a>.</p>
</div>
</div>
</div>


                        
                    </div>
                </div>
            </div>
        </div>
    </div>    


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../../../../',
            VERSION:'1.0.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
    <script type="text/javascript" src="../../../../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../../../../_static/clipboard.min.js"></script>
    <script type="text/javascript" src="../../../../../../../_static/copybutton.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script type="text/javascript" src="../../../../../../../_static/js/theme.js"></script>
  
    <div class="footer" role="contentinfo">
        <div class="container">
            &#169; Copyright bladedisc-dev@list.alibaba-inc.com.
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.3.2.
        </div>
    </div>  

</body>
</html>